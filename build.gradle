// ***************************************************************************
// **                          Requirements                                 **
// **    - Gradle 2.6                                                       **
// **    - add 'artifactoryUser' to [GRADLE_HOME]/gradle.properties         **
// **    - add 'artifactoryPassword' to [GRADLE_HOME]/gradle.properties     **
// **                                                                       **
// ***************************************************************************

// artifactory plugin
plugins {
    id 'com.jfrog.artifactory' version '3.1.1'
}

apply plugin: 'java'
apply plugin: 'maven-publish'

// needed for M4 generation
ant.importBuild 'm4-build.xml'

[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

artifactory {
    contextUrl = "${artifactoryContextURL}"
    publish {
        repository {
            repoKey = "${artifactoryPublishRepo}"
            username = "${artifactoryUser}"
            password = "${artifactoryPassword}"
            maven = true
        }
        defaults {
            publications ('mavenJava')
        }
    }
    resolve {
        repository {
            repoKey = "${artifactoryResolveRepo}"
            username = "${artifactoryUser}"
            password = "${artifactoryPassword}"
            maven = true
        }
    }
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
            groupId = "${group}"
            version = "${version}"
        }
    }
}

repositories {
    mavenCentral()       
}

dependencies {    
    testCompile group: 'junit', name: 'junit', version: '4.10'
}